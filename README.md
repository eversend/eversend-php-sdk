# Eversend PHP SDK

![Packagist Version](https://img.shields.io/packagist/v/eversend/eversend-php-sdk) ![Packagist License](https://img.shields.io/packagist/l/eversend/eversend-php-sdk) ![Packagist Downloads](https://img.shields.io/packagist/dm/eversend/eversend-php-sdk)

PHP SDK for Eversend payments API

## Table of Contents

1. [Installation](#installation)
2. [Initialization](#initialization)
3. [Usage](#usage)
4. [Contribution Guidelines](#contribution-guidelines)
5. [License](#license)
## Installation

```sh
composer require eversend/eversend-php-sdk
```

## Usage

```php
use Eversend\Eversend

$eversendClient = new Eversend(
    clientId= 'clientId',
    clientSecret= 'clientSecret',
    version=1
);
```

You can get your clientId and clientSecret from the settings section in the [dashboard](https://business.eversend.co/settings)

## Usage
### Wallets

**Get all wallets**

```php
$wallets = eversendClient.wallets().list();
```

**Get one wallet**

```php
$usdWallet = eversendClient.wallets().get(walletId: "USD");
```
### Transactions

**Get all transactions**

```php
$transactions = eversendClient.transactions().list(page: 1, limit: 10);
```

If `page` and `limit` are not set, the default of `1` and `10` are used respectively.

**Get one transaction**

```php
$transaction = eversendClient.transactions().get(
    transactionId: "EVS12345678"
);
```

### Exchange

To exchange from one wallet to another, you first have to generate a quotation. This returns a token with a 30s timeout that you can use to make the exchange.

**Get exchange quotation**

```php
$quotation = eversendClient.exchange().createQuotation(
    from: "USD", to: "UGX", amount: 10.0
);
```

**Exchange currency**

```php
$exchange = eversendClient.exchange().createExchange(
    token: "dhhsggajjshhdhdhd",
    transactionRef: "EVS-12345678", // optional field
);
```

### Beneficiaries

**Get beneficiaries**

```php
$beneficiaries = eversendClient.beneficiaries.list(
    page: 1,
    limit: 10,
);
```

If `page` and `limit` are not set, the default of `1` and `10` are used respectively.

**Search beneficiaries**

```php
$beneficiaries = eversendClient.beneficiaries().list(
    search: "Okello",
    page: 1,
    limit: 10,
);
```

**Get single beneficiary**

```php
$beneficiary = eversendClient.beneficiaries().get(
    beneficiaryId: 100
);
```

**Create a beneficiary**

```php
$beneficiary = eversendClient.beneficiaries.create(
    firstName: "John",
    lastName: "Okello",
    country: "UG", // Alpha-2 country code
    phoneNumber: "+256712345678", // Should be in international format
    bankAccountName: "John Okello",
    bankAccountNumber: "12345678",
    bankName: "Stanbic Bank",
    bankCode: 1234 // You can get the bank code from payouts.getDeliveryBanks()
);
```
>Note that all bank fields are optional if bank payments will not be required

**Edit a beneficiary**

```php
$beneficiary = eversendClient.beneficiaries.update(
    beneficiaryId: 100,
    firstName: "John",
    lastName: "Okello",
    country: "UG", // Alpha-2 country code
    phoneNumber: "+256712345678", // Should be in international format
    bankAccountName: "John Okello",
    bankAccountNumber: "12345678",
    bankName: "Stanbic Bank",
    bankCode: 1234 // You can get the bank code from payouts.getDeliveryBanks()
);
```
>Note that all bank fields are optional if bank payments will not be required

**Delete a beneficiary**

```php
$beneficiary = eversendClient.beneficiaries.delete(
    beneficiaryId: 100
);
```

### Collections

**Get collection fees**

```php
$collectionFees = eversendClient.collections().getFees(
    amount: 1000,
    currency: "KES",
    method: "momo"
);
```

**Get collection OTP**

>Required when initiating mobile money collections
```php
$collectionOTP = eversendClient.collections().getOTP(
    phone: "+256712345678"
);
```

**Initiate Mobile Money collection**

```php
eversendClient.collections().initiateMomo(
    phone: "+256712345678",
    amount: 1000,
    country: "UG",
    currency: "UGX",
    pin: 123456, // From phone number passed in Get Collection OTP
    pinId: "dg524fhsgfde", // From Get Collection OTP
    transactionRef: "EVS-12345678", // Optional transaction ref generated by you
    customer: { name: "John Okello" } // Optional customer object with your metadata
);
```
### Payouts

**Get payout quotation**

```php
$quotation = eversendClient.payouts.getQuotation(
    amount: 100,
    amountType: "SOURCE", // amountType can be SOURCE or DESTINATION
    sourceWallet: "USD",
    destinationCountry: "KE",
    destinationCurrency: "KES"
);
```
>`amountType` refers to whether you want amount to represent `sourceWallet` (SOURCE) or `destinationCurrency` (DESTINATION)

**Pay existing beneficiary**

```php
$payout = eversendClient.payouts.initiate(
    beneficiaryId: 100,
    quotationToken: "token",
    transactionRef: "EVS-12345678" // Optional transaction ref generated by you
);
```

**Pay new beneficiary**

```php
$payout = eversendClient.payouts.initiate({
    firstName: "John",
    lastName: "Okello",
    country: "UG", // Alpha-2 country code
    phoneNumber: "+256712345678", // Should be in international format
    bankAccountName: "John Okello",
    bankAccountNumber: "12345678",
    bankName: "Stanbic Bank",
    bankCode: 1234, // You can get the bank code from payouts.getDeliveryBanks()
    quotationToken: "token",
    transactionRef: "EVS-12345678" // Optional transaction ref generated by you
});
```

**Get delivery countries**

```php
$countries = eversendClient.payouts.countries()
```

**Get delivery banks**

```php
$banks = eversendClient.payouts.banks(
    country: "UG"
);
```
## Contribution Guidelines

Contributions are welcome and encouraged. Learn more about our contribution guidelines [here](/CONTRIBUTING.md)
## License

MIT Â© [Eversend]()
